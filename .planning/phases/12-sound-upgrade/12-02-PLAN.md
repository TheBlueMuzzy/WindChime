---
phase: 12-sound-upgrade
plan: 02
type: execute
---

<objective>
Splice 100 five-second clips from the curated Source2 recordings with smooth fade envelopes.

Purpose: Produce the new sound library that replaces the old 24 clips — 100 high-quality clips evenly distributed across source recordings.
Output: 100 mp3 files in `audio/spliced2/` named `Chime_001.mp3` through `Chime_100.mp3`.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-sound-upgrade/12-CONTEXT.md
@.planning/phases/12-sound-upgrade/12-01-SUMMARY.md

**Key files:**
@audio/Source2/ (curated source recordings — count determined after Plan 01)
@scripts/detect-duplicates.py (Python audio environment already set up)

**From CONTEXT.md:**
- 5-second clips, 200ms fade-in, 500ms fade-out
- Even spread: aim for equal clips per source. If a source is shorter than needed, clips can overlap
- Output to `audio/spliced2/` during production
- Naming: `Chime_001.mp3` through `Chime_100.mp3` (3-digit zero-padded for 100 clips)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create splicing script</name>
  <files>scripts/splice-chimes.py</files>
  <action>
Create `scripts/splice-chimes.py` that:

1. Reads all mp3 files from `audio/Source2/` (post-curation)
2. Determines clip allocation: `100 / num_sources` clips per source (remainder distributed to longest sources)
3. For each source:
   - Load with pydub
   - Calculate evenly-spaced start positions for the allocated number of clips
   - If source is shorter than `clips * 5s`, allow overlapping start positions (shift evenly across available duration)
   - Extract 5000ms clip at each start position
   - Apply 200ms fade-in and 500ms fade-out using pydub's `fade_in()` and `fade_out()` methods
4. Number clips sequentially: `Chime_001.mp3` through `Chime_100.mp3`
5. Export to `audio/spliced2/` as mp3 (192kbps for quality)
6. Print summary: which source contributed which clip numbers, durations, any overlap warnings

**Important:** Use 3-digit zero-padding (`Chime_001` not `Chime_01`) since we now have 100 clips instead of 24.

Run the script after creation.
  </action>
  <verify>ls audio/spliced2/ | wc -l returns 100, and a few random files can be played back</verify>
  <done>100 mp3 clips in `audio/spliced2/`, each ~5 seconds with fade envelopes, named `Chime_001` through `Chime_100`</done>
</task>

<task type="auto">
  <name>Task 2: Copy new clips to public/sounds/ and update chime-data.js</name>
  <files>public/sounds/, public/chime-data.js</files>
  <action>
1. Delete all existing files in `public/sounds/` (the old 24 clips)
2. Copy all 100 clips from `audio/spliced2/` to `public/sounds/`
3. Update `scripts/generate-chime-list.js` to read from `audio/spliced2/` instead of `audio/spliced/`
4. Run `npm run update-chimes` to regenerate `public/chime-data.js` with the new 100-item list
5. Verify `chime-data.js` contains all 100 Chime IDs

**Note:** The old `audio/spliced/` directory still exists — do NOT delete it yet (Plan 03 handles cleanup). Just ensure `public/sounds/` has the new clips.
  </action>
  <verify>ls public/sounds/ | wc -l returns 100, cat public/chime-data.js shows 100 entries</verify>
  <done>public/sounds/ has 100 new clips, chime-data.js lists all 100 Chime IDs</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] 100 clips exist in `audio/spliced2/` and `public/sounds/`
- [ ] Each clip is ~5 seconds with fade envelopes
- [ ] `chime-data.js` lists all 100 Chime IDs
- [ ] No old clips remain in `public/sounds/`
</verification>

<success_criteria>

- 100 new clips produced from Source2 recordings
- Clips properly faded (200ms in, 500ms out)
- Public sound directory updated
- chime-data.js regenerated
- Ready for Plan 03 (QR generation + cleanup)
</success_criteria>

<output>
After completion, create `.planning/phases/12-sound-upgrade/12-02-SUMMARY.md`
</output>
