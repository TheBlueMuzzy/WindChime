---
phase: 09-qr-display-page
plan: 01
type: execute
---

<objective>
Create a QR Display Page that shows all chime QR codes on a computer screen for phone scanning.

Purpose: Enable spot-testing any chime by pointing a phone at QR codes displayed on a monitor, without needing printed cards.
Output: A `/codes` route showing the existing 3-slot section at top, plus an auto-generated grid of all chime QR codes below.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/9-qr-display-page/9-CONTEXT.md
@.planning/phases/08-git-deploy/08-01-SUMMARY.md

# Key source files:
@src/App.tsx
@src/main.tsx
@vite.config.ts
@package.json

# Existing test page (to preserve/evolve):
@test-assets/qr-chime-1.html

**Tech stack available:** React 19, Vite 7, TypeScript, gh-pages deploy
**Established patterns:** BASE_URL prefix for public assets, inline styles, port 5213

**Constraining decisions:**
- QR rawValue used directly as sound ID (QR must encode exact string like `Chime_01`)
- BASE_URL prefix required for all public asset paths
- App is single-page, no router installed
- 24 sounds in public/sounds/ named Chime_01.mp3 through Chime_24.mp3

**From CONTEXT.md (Muzzy's vision):**
- Existing top section stays unchanged
- Grid below auto-generates from sound files — no hardcoded list
- Grid is non-interactive, display only
- QR codes must be scannable from phone pointed at monitor
- Clear visual separation between top slots and grid
- Every QR code appears in grid (including ones in top slots)
- Titles on each grid item

**Important note:** The "existing page" is currently just `test-assets/qr-chime-1.html` — a single QR code using an external API. This must be evolved into a proper React page with 3 active slots at top (matching the 3-card game concept) plus the full grid below. The existing test HTML approach (external QR API images) should be replaced with a proper React QR generation library for reliability.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add QR generation library and hash router, create QR display page with 3 active slots + full grid</name>
  <files>package.json, src/main.tsx, src/App.tsx, src/pages/CodesPage.tsx</files>
  <action>
1. Install `qrcode.react` (SVG-based QR generation, React component) and no router — use simple hash-based routing manually (check `window.location.hash`).

2. Update `src/main.tsx` to render a root component that checks the hash:
   - `#/codes` → render CodesPage
   - anything else → render App (scanner)
   This avoids adding react-router as a dependency. Use a simple `Root` component with useState for the hash, listening to `hashchange` events.

3. Create `src/pages/CodesPage.tsx`:

   **Sound file list:** Build the chime ID list the same way App.tsx does — a `CHIME_IDS` array from `Chime_01` to `Chime_24`. BUT to make this auto-detect friendly for future growth, generate the array programmatically: loop 1-99, check if `Chime_${padded}` would match a known set. For now, share the CHIME_IDS constant by extracting it to a new file `src/chimeIds.ts` that both App.tsx and CodesPage.tsx import. This constant IS the source of truth — when new sounds are added, update this one file.

   NOTE: True filesystem auto-detection (reading the /spliced folder at build time) would require a Vite plugin or build script. Since CHIME_IDS already serves as the registry and Muzzy updates it when adding sounds, use CHIME_IDS as the source. Document in a comment that adding a new sound means adding its ID here.

   **Top section (3 active slots):**
   - 3 large QR codes side by side (Chime_01, Chime_02, Chime_03 as defaults)
   - Each has a title label below it (e.g., "Chime 01")
   - QR codes rendered at 200x200px using `<QRCodeSVG>` from qrcode.react
   - The `value` prop must be the exact chime ID string (e.g., `Chime_01`) — this is what the scanner app expects as rawValue

   **Visual separator:**
   - A horizontal rule or spacer (~40px) between top slots and grid
   - Optional subtle text label like "All Chimes" above the grid

   **Grid section:**
   - CSS Grid: `repeat(auto-fill, minmax(180px, 1fr))` with gap
   - Each cell: QR code (150x150px) + title label below
   - Title: filename without extension, underscores replaced with spaces (e.g., "Chime 01")
   - All CHIME_IDS rendered, including the 3 that appear in the active slots
   - Non-interactive — no click handlers, no hover effects

   **Page styling:**
   - White background (QR codes need contrast)
   - Inline styles (consistent with project pattern)
   - Page title at top: "Wind Chime — QR Codes"
   - Responsive grid that wraps naturally
   - Each QR code should have enough white space/margin around it that a phone camera can isolate individual codes when scanning from a monitor

4. Update `src/App.tsx`:
   - Import CHIME_IDS from the new shared file instead of defining inline
   - No other changes to App.tsx behavior

  **What to avoid:**
  - Do NOT use an external QR API (like api.qrserver.com) — use the local qrcode.react library for reliability and offline support
  - Do NOT add react-router — hash-based routing is simpler and avoids GitHub Pages SPA issues
  - Do NOT make the grid interactive — it's display-only
  - Do NOT change the scanner app's behavior in any way
  </action>
  <verify>
  - `npm run build` succeeds with no TypeScript errors
  - Dev server at https://localhost:5213/#/codes shows the QR display page
  - Dev server at https://localhost:5213/ still shows the scanner app unchanged
  - All 24 QR codes visible in the grid
  - 3 large QR codes visible in the top active slots section
  </verify>
  <done>
  - CodesPage renders with 3 active slots at top + 24-item grid below
  - QR codes generated locally via qrcode.react (no external API)
  - Hash routing works: /#/codes → display page, / → scanner
  - CHIME_IDS extracted to shared module used by both App.tsx and CodesPage.tsx
  - Build passes cleanly
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>QR Display Page at /#/codes with 3 active slots and full 24-chime grid</what-built>
  <how-to-verify>
    1. Dev server should already be running. Visit: https://localhost:5213/WindChime/#/codes
    2. Confirm: 3 large QR codes at top with titles (Chime 01, Chime 02, Chime 03)
    3. Confirm: Visual separator between top slots and grid
    4. Confirm: Grid of 24 QR codes below, each with a title
    5. Confirm: QR codes are large enough to scan individually from a monitor
    6. Test scanning: Open https://localhost:5213/WindChime/ on your phone, tap to unlock audio, point camera at one of the QR codes on the monitor — it should play the corresponding chime
    7. Confirm: Scanner app at https://localhost:5213/WindChime/ still works normally (no hash)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] /#/codes route shows QR display page
- [ ] / route shows scanner app unchanged
- [ ] All 24 QR codes render in grid
- [ ] QR codes scannable from phone camera pointed at monitor
- [ ] CHIME_IDS shared between scanner and display page
</verification>

<success_criteria>

- QR display page accessible at /#/codes
- 3 active slots at top with large QR codes
- Auto-generated grid of all 24 chime QR codes below
- QR codes scannable from a phone camera pointed at the monitor
- Scanner app unchanged at root URL
- Phase 9 complete
</success_criteria>

<output>
After completion, create `.planning/phases/9-qr-display-page/09-01-SUMMARY.md`
</output>
