# Milestone v0.2: Wind Chime Companion App

**Status:** SHIPPED 2026-02-10
**Phases:** 1-12 (11 complete, Phase 11 blocked on external iPhone tester)
**Total Plans:** 15 executed

## Overview

Turn a physical wind chime card layout into a live audio experience. Built from scratch: camera-based QR scanning triggers layered wind chime sounds in real time. Upgraded from 24 placeholder clips to 100 curated sounds with dynamic runtime discovery.

## Phases

### Phase 1: Project Foundation
**Goal**: Running Vite dev server with a React/TS app shell showing a full-screen camera placeholder
**Depends on**: Nothing (first phase)
**Plans**: 2 plans

Plans:
- [x] 01-01: Scaffold Vite + React + TS project, install core dependencies
- [x] 01-02: App shell layout — full-screen landscape container, dark background, camera placeholder

### Phase 2: QR Scanner Integration
**Goal**: Phone camera activates and detects a single QR code, displaying its raw value on screen
**Depends on**: Phase 1
**Plans**: 3 plans

Plans:
- [x] 02-01: Install @yudiel/react-qr-scanner and barcode-detector polyfill, configure scanner component
- [x] 02-02: Camera permissions flow — request rear camera, handle grant/deny
- [x] 02-03: Single QR detection — display detected QR value on screen as proof of life

### Phase 3: Audio Engine Core
**Goal**: Detecting a QR code triggers a sound playing through Web Audio API
**Depends on**: Phase 2
**Plans**: 3 plans

Plans:
- [x] 03-01: Create useAudioEngine hook — AudioContext setup, buffer loading, single sound playback
- [x] 03-02: Connect QR detection to audio — detected code triggers mapped sound
- [x] 03-03: Handle mobile audio unlock (iOS/Android require user gesture to start AudioContext)

### Phase 4: Test Content
**Goal**: Real wind chime sounds and QR test content ready for testing
**Depends on**: Phase 3
**Plans**: 1 plan (plan 02 superseded by Phase 9)

Plans:
- [x] 04-01: Source 24 real wind chime sounds, splice, integrate into app

### Phase 5: Multi-Code Detection
**Goal**: Camera detects multiple QR codes simultaneously
**Depends on**: Phase 4
**Plans**: 1 plan (plan 02 cut — L-R sorting not needed)

Plans:
- [x] 05-01: Enable multi-code detection in scanner, handle array of detected codes

### Phase 6: Sound Layering & Fade
**Goal**: Multiple sounds play concurrently with smooth layering and natural fade-out
**Depends on**: Phase 5
**Status**: Done early in Phase 3
**Plans**: 3 plans

Plans:
- [x] 06-01: Support concurrent audio sources
- [x] 06-02: Add GainNode per sound for individual volume control
- [x] 06-03: Implement fade envelopes — fast fade-in, fade-out using gain ramps

### Phase 7: Detection State & Cooldowns
**Goal**: QR codes can re-trigger after leaving/re-entering frame
**Status**: Superseded by allowMultiple + isPlaying pattern

Plans:
- [x] 07-01: Detection state (handled by allowMultiple)
- [x] 07-02: Re-trigger logic (handled by isPlaying + MAX_SIMULTANEOUS cap)

### Phase 8: Git + Deploy
**Goal**: WindChime app in a GitHub repo, deployed to GitHub Pages
**Depends on**: Phase 7
**Plans**: 1 plan

Plans:
- [x] 08-01: Create GitHub repo, configure Vite base path, deploy script, push to GitHub Pages

### Phase 9: QR Display Page
**Goal**: Separate hosted page showing QR codes on a computer screen for phone scanning
**Depends on**: Phase 8
**Plans**: 1 plan

Plans:
- [x] 09-01: QR Display Page with dynamic chime grid, randomize, and hide/show toggle

### Phase 10: Polish
**Goal**: Visual detection indicator + camera permission denied help screen
**Depends on**: Phase 8
**Plans**: 1 plan

Plans:
- [x] 10-01: Visual feedback on QR detection + camera permission denied recovery screen

### Phase 11: iPhone Testing & Fixes
**Goal**: App works on iOS Safari — tested on real iPhone device
**Depends on**: Phase 8
**Status**: BLOCKED — needs external iPhone tester. Deferred to next milestone.

Plans:
- [ ] 11-01: iOS Safari pre-flight audit, deploy, real-device testing with iPhone tester

### Phase 12: Sound Upgrade
**Goal**: Replace 24 old clips with 100 new clips, generate QR codes, make app fully dynamic
**Depends on**: Phase 8, Phase 3
**Plans**: 5 plans

Plans:
- [x] 12-01: Python setup + duplicate detection analysis
- [x] 12-02: Splice 100 five-second clips from curated sources with fade envelopes
- [x] 12-03: QR code generation (100 PNGs) + old sound directory cleanup
- [x] 12-04: Dynamic sound discovery via GitHub API (app + codes.html, remove hardcoded lists)
- [x] 12-05: Deploy to GitHub Pages + end-to-end verification

## Milestone Summary

**Key Decisions:**
- @yudiel/react-qr-scanner — only React lib with multi-code + position + iOS + Android
- Web Audio API — precise layering, fade envelopes, concurrent sounds
- allowMultiple={true} on Scanner — continuous scanning, no cooldown system needed
- Max 3 simultaneous sounds — hard cap in useAudioEngine
- GitHub API for dynamic sound discovery with manifest.json fallback
- Master push required before deploy — API reads from remote master

**Issues Resolved:**
- Mobile audio autoplay policy — lazy AudioContext + user gesture gating
- GitHub Pages BASE_URL pathing for subdirectory hosting
- Camera detection reliability — video element polling instead of onScan callback
- GitHub Pages deploy queue delays — cancel and retrigger pattern

**Issues Deferred:**
- Phase 11 (iPhone Testing) — blocked on external tester availability
- deploy.js script stale (references audio/spliced2/ which no longer exists)

**Technical Debt Incurred:**
- deploy.js needs updating (audio/spliced2/ path no longer valid)
- No automated tests (prototype scope)

---
_For current project status, see .planning/ROADMAP.md_
