---
phase: 10-polish
plan: 01
type: execute
---

<objective>
Add visual feedback when QR codes are detected and a helpful screen when camera permission is denied.

Purpose: Users know scanning is working (visual indicator) and can recover from accidental permission denial (help screen).
Output: Detection feedback visible on camera view, permission-denied screen with browser-specific recovery steps.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Key source files:
@src/App.tsx
@src/hooks/useAudioEngine.ts
@src/components/QrScanner.tsx

**Current UX flow:**
1. App loads â†’ dark screen with "Tap anywhere to enable sound"
2. User taps â†’ camera activates, overlay goes transparent
3. QR codes detected â†’ sounds play (no visual indicator currently)
4. Tap again â†’ sound off, overlay darkens

**What's missing:**
- No visual feedback that a QR code was successfully detected and triggered a sound
- If user denies camera permission, they see nothing helpful

**Constraints:**
- Visual indicator must not obstruct camera view
- Keep it subtle â€” this is a companion app, not a full UI
- Camera denial screen must explain how to fix it in plain language
- Different browsers have different steps to re-enable camera
</context>

<tasks>

<task type="auto">
  <name>Task 1: Visual detection indicator</name>
  <files>src/App.tsx</files>
  <action>
Add a subtle visual indicator when a QR code is successfully detected and triggers a sound:

1. When onScan fires and a sound plays, show a brief visual pulse or glow effect
2. Options (pick the simplest that looks good):
   - Brief screen-edge glow (CSS animation, ~300ms)
   - Small dot or icon that appears near the bottom when sounds are active
   - Brief flash of color on the overlay border
3. The indicator should:
   - Appear only when a NEW sound starts (not continuously while playing)
   - Be visible but not distracting
   - Auto-dismiss after a short duration
   - Work on the transparent overlay (when sound is enabled)
  </action>
  <verify>Point phone at QR code â€” see a brief visual indicator when sound triggers. Indicator doesn't block camera view.</verify>
  <done>Visual detection feedback shows when QR triggers sound</done>
</task>

<task type="auto">
  <name>Task 2: Camera permission denied help screen</name>
  <files>src/App.tsx or src/components/PermissionDenied.tsx</files>
  <action>
Detect when camera permission is denied and show a helpful recovery screen:

1. Detect denial via the scanner's error callback or navigator.permissions API
2. When denied, show a full-screen help message:
   - "Camera access was blocked"
   - "To fix this:"
   - Browser-specific instructions:
     - **Chrome (Android):** "Tap the lock icon (ðŸ”’) in the address bar â†’ Camera â†’ Allow â†’ Reload"
     - **Safari (iOS):** "Go to Settings â†’ Safari â†’ Camera â†’ Allow â†’ Come back and reload"
     - **Generic fallback:** "Check your browser settings to allow camera access, then reload this page"
   - A "Reload" button that calls `window.location.reload()`
3. Detect browser using User-Agent (simple check, not a full library):
   - Contains "Safari" but not "Chrome" â†’ Safari instructions
   - Contains "Chrome" â†’ Chrome instructions
   - Otherwise â†’ generic
  </action>
  <verify>Deny camera permission when prompted â†’ see helpful screen with browser-specific steps. "Reload" button works.</verify>
  <done>Permission denied screen with recovery instructions</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Visual detection indicator + camera permission denied help screen</what-built>
  <how-to-verify>
    1. Open app on phone, tap to enable
    2. Point at QR code â€” verify visual indicator appears when sound plays
    3. Verify indicator is subtle and doesn't block camera
    4. To test permission denied: clear site data in browser settings, reload, deny camera when asked
    5. Verify helpful screen appears with correct instructions for your browser
    6. Tap Reload â€” verify page reloads and asks for permission again
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Visual indicator shows on QR detection
- [ ] Indicator is subtle and non-blocking
- [ ] Camera denied screen shows with browser-specific steps
- [ ] Reload button works
- [ ] `npm run build` succeeds
- [ ] Commit all changes
- [ ] Re-deploy to GitHub Pages
</verification>

<success_criteria>
- Users get visual confirmation scanning is working
- Users can recover from accidental camera denial
- No UI bloat â€” minimal, functional additions
</success_criteria>

<output>
After completion, create `.planning/phases/10-polish/10-01-SUMMARY.md`
</output>
